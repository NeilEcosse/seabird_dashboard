"0",""
"0","# Get distinct list of start stations with number of trips"
"0","start_locations <- tibble(nyc_bikes_df %>% "
"0","  group_by(start_station, start_lat, start_long) %>% "
"0","  summarise(number_of_trips = n())"
"0",")"
"0","start_locations <- start_locations %>% "
"0","  group_by(start_station, start_lat, start_long) %>% "
"0","  summarise(number_of_trips = sum(number_of_trips)) %>% "
"0","  arrange(desc(number_of_trips))"
"2","`summarise()` regrouping output by 'start_station', 'start_lat' (override with `.groups` argument)
"
"0","# Create colour scheme for markers based on number of trips"
"0","start_locations <- start_locations %>% "
"0","  mutate(trips_group = cut(number_of_trips, breaks = c(0, 50, 100, 200, 300, Inf),"
"0","                             labels = c(""orange"", ""light yellow"",""darkred"", ""red"", ""purple""),"
"0","                 include.lowest = TRUE)) "
"0",""
"0","icons <- awesomeIcons(icon = ""whatever"","
"0","                      iconColor = ""black"","
"0","                      library = ""ion"","
"0","                      markerColor = start_locations$trips_group)"
"0",""
"0",""
"0",""
"0",""
"0","# Data for leaflet"
"0","start_data_map <- start_locations %>% "
"0","  leaflet() %>% "
"0","  addTiles() %>% "
"0","  addAwesomeMarkers(lng = ~ start_locations$start_long, "
"0","             lat = ~ start_locations$start_lat,"
"0","             icon = icons,"
"0","             popup = ~ as.character(start_locations$number_of_trips)"
"0","  )"
"0","start_data_map"
