"0","# source data for trips by time of day"
"0","nyc_bikes_df %>%"
"0","  index_by(start_hour_numeric) %>%"
"0","  group_by(age_group) %>% "
"0","  summarise(number_of_trips = n()) %>% "
"0","  mutate("
"0","    trips_moving_average = slide_dbl("
"0","      number_of_trips,"
"0","      ~ mean(., na.rm = TRUE),"
"0","      .before = 25,"
"0","      .after = 25,"
"0","      .complete = FALSE"
"0","    )"
"0","  ) %>% "
"0","ggplot() +"
"0","  aes(x = start_hour_numeric, y = number_of_trips) +"
"0","  geom_line(colour = ""light grey"") +"
"0","  geom_line(aes(y = trips_moving_average), colour = ""red"") +"
"0","  scale_x_continuous(breaks = c(3, 6, 9, 12, 15, 18, 21, 24)) +"
"0","  scale_y_continuous(breaks = c(2, 4, 6, 8)) +"
"0","  theme_minimal() +"
"0","  labs("
"0","    title = ""Number of trips by time of day"","
"0","    subtitle = ""By age group \n"","
"0","    x = ""\n Time (24h)"","
"0","    y = ""Number of trips \n"""
"0","  ) +"
"0","  facet_wrap(~age_group)"
